# WorkShop RAG Chatbot ด้วย Streamlit, Qdrant, และ Groq

workshop นี้เป็นแชทบอทที่ใช้เทคนิค **Retrieval-Augmented Generation (RAG)** โดยใช้ **Streamlit** สำหรับสร้างอินเทอร์เฟซผู้ใช้ (UI), **Qdrant** เป็นฐานข้อมูลเวกเตอร์, และ **Groq** เป็นโมเดลภาษา (LLM) ที่ใช้สร้างคำตอบ แชทบอทนี้สามารถประมวลผลไฟล์ PDF, แยกข้อความจากไฟล์, และตอบคำถามผู้ใช้โดยใช้ข้อมูลจากไฟล์ PDF ที่อัปโหลด

---
## TO-DO
- [ ] model ที่ใช้ในการตอบคำถาม ให้เป็น model ของไทยเอง 
- [ ] embedding_model ให้เป็น model ของไทยเอง

## คุณสมบัติ

- **อัปโหลดไฟล์ PDF**: ผู้ใช้สามารถอัปโหลดไฟล์ PDF และระบบจะแยกข้อความจากไฟล์
- **ฐานข้อมูลเวกเตอร์ (Qdrant)**: ข้อความที่แยกได้จะถูกแปลงเป็นเวกเตอร์และเก็บไว้ใน **Qdrant** ซึ่งเป็นฐานข้อมูลเวกเตอร์ in RAM
- **ตอบคำถาม**: ผู้ใช้สามารถถามคำถาม และระบบจะค้นหาข้อมูลที่เกี่ยวข้องจาก PDF โดยใช้ Qdrant และสร้างคำตอบโดยใช้โมเดลภาษา **Groq**
- **การจัดการคีย์ API**: คีย์ API และการตั้งค่าที่สำคัญจะถูกเก็บไว้ในไฟล์ `.env` เพื่อความปลอดภัย

---

## สิ่งที่ต้องเตรียม (Requirements)

ก่อนรันแอปพลิเคชันนี้ ต้องมีสิ่งต่อไปนี้:

1. ติดตั้ง **Python 3.8 หรือสูงกว่า**
2. มี **Groq API Key** ซึ่งสามารถขอได้ที่ [เว็บไซต์ Groq](https://groq.com/)
3. ติดตั้งไลบรารี Python ที่จำ
4. เป็น (อยู่ในไฟล์ `requirements.txt`)

---

## การติดตั้ง

1. **โคลนโปรเจกต์**:
   ```bash
   git clone https://github.com/JeerasakAnanta/workshop_rag_rmutl.git
   cd rag-chatbot
   ```

2. **สร้าง virtual environment** (จำเป็น):
   - linux 
   ```bash
   python -m venv .env_workspace
   source .env_workspace/bin/activate
   ```
   - window 
   ```bash
   python -m venv .env_workspace
   .env_workspace\Scripts\activate
   ```

   - linux
     ```bash
     source venv/bin/activate  
     ```
   - window บน Windows ใช้ `venv\Scripts\activate`
     ```bash
      .\venv\Scripts\activate.bat
     ```

3. **ติดตั้ง dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **ตั้งค่าไฟล์ `.env`**:
   - สร้างไฟล์ชื่อ `.env` ในโฟลเดอร์หลัก
   - เพิ่ม Groq API Key ของคุณลงในไฟล์:
     ```bash
      GROQ_API_KEY=Your_Groq_Api_Key_Here
     ```

---

## การรันแอปพลิเคชัน

1. รันแอปพลิเคชันด้วย Streamlit:
   ```bash
   streamlit run app.py
   ```

2. เปิดเบราว์เซอร์และไปที่ URL ที่แสดงใน terminal (ปกติจะเป็น `http://localhost:8501`)

3. **อัปโหลดไฟล์ PDF** โดยใช้ตัวอัปโหลดไฟล์ในอินเทอร์เฟซของ Streamlit

4. เมื่อประมวลผลไฟล์ PDF เสร็จสิ้น คุณสามารถเริ่มถามคำถามในช่องแชทได้

---

## วิธีการทำงาน

### 1. **การประมวลผลไฟล์ PDF**
   - แอปพลิเคชันใช้ `PyPDF2` เพื่อแยกข้อความจากไฟล์ PDF ที่อัปโหลด
   - ข้อความจะถูกแบ่งเป็นส่วนย่อย (เช่น ย่อหน้าหรือประโยค) เพื่อให้การค้นหามีประสิทธิภาพมากขึ้น

### 2. **ฐานข้อมูลเวกเตอร์ (Qdrant)**
   - ข้อความที่แยกได้จะถูกแปลงเป็นเวกเตอร์โดยใช้โมเดล `SentenceTransformer` (`all-MiniLM-L6-v2`)
   - เวกเตอร์เหล่านี้จะถูกเก็บไว้ในฐานข้อมูล Qdrant เพื่อให้สามารถค้นหาข้อมูลที่คล้ายกันได้อย่างรวดเร็ว

### 3. **การตอบคำถาม**
   - เมื่อผู้ใช้ถามคำถาม ระบบจะ:
     1. แปลงคำถามเป็นเวกเตอร์
     2. ค้นหาข้อความที่เกี่ยวข้องที่สุดจากฐานข้อมูล Qdrant
     3. ส่งข้อความที่ค้นพบและคำถามไปยังโมเดลภาษา Groq เพื่อสร้างคำตอบ

### 4. **อินเทอร์เฟซ Streamlit**
   - อินเทอร์เฟซผู้ใช้ถูกสร้างด้วย **Streamlit** ซึ่งช่วยให้ผู้ใช้สามารถอัปโหลดไฟล์ PDF และสนทนากับแชทบอทได้ง่าย

---

## โครงสร้างไฟล์

```
rag-chatbot/
├── app.py                  # ไฟล์หลักของแอปพลิเคชัน
├── .env                    # ไฟล์สำหรับเก็บ environment variables (API keys)
├── requirements.txt        # รายการ dependencies
├── README.md               # ไฟล์นี้
```

---

## การปรับแต่ง

### 1. **เปลี่ยนโมเดลสำหรับสร้างเวกเตอร์**
   - โมเดลเริ่มต้นคือ `all-MiniLM-L6-v2` คุณสามารถเปลี่ยนเป็นโมเดลอื่นจาก `SentenceTransformer` ได้
   - แก้ไขบรรทัดต่อไปนี้ใน `app.py`:
     ```python
     embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
     ```

### 2. **ใช้ LLM อื่น**
   - หากต้องการใช้ LLM อื่น (เช่น OpenAI GPT) ให้แทนที่การเรียกใช้ Groq API ด้วย API ของ LLM ที่คุณเลือก

### 3. **ใช้ฐานข้อมูล Qdrant แบบถาวร**
   - โดยค่าเริ่มต้น Qdrant จะทำงานในโหมด In-Memory หากต้องการใช้ฐานข้อมูลถาวร ให้แทนที่ `:memory:` ด้วย URL ของเซิร์ฟเวอร์ Qdrant:
     ```python
     qdrant_client = QdrantClient("http://localhost:6333")
     ```

---

## ตัวอย่างคำถาม

- **คำถาม**: "เอกสารนี้พูดถึงเรื่องอะไร?"
- **คำถาม**: "สรุปประเด็นสำคัญได้ไหม?"
- **คำถาม**: "มีข้อดีอะไรบ้างที่กล่าวถึงในเอกสาร?"

---

## การแก้ไขปัญหา

### 1. **ไม่พบ API Key**
   - ตรวจสอบว่าไฟล์ `.env` ถูกจัดรูปแบบและอยู่ในตำแหน่งที่ถูกต้อง
   - ตรวจสอบว่าตัวแปร `GROQ_API_KEY` ถูกตั้งค่าถูกต้อง

### 2. **ปัญหาในการแยกข้อความจาก PDF**
   - หากไฟล์ PDF มีภาพสแกนหรือองค์ประกอบที่ไม่ใช่ข้อความ การแยกข้อความอาจล้มเหลว ให้ใช้เครื่องมือ OCR สำหรับไฟล์ประเภทนี้

### 3. **ปัญหาในการเชื่อมต่อ Qdrant**
   - หากใช้เซิร์ฟเวอร์ Qdrant ระยะไกล ตรวจสอบว่าเซิร์ฟเวอร์ทำงานและสามารถเข้าถึงได้

---

## Dependencies

- **Streamlit**: สำหรับสร้างอินเทอร์เฟซเว็บ
- **Groq**: สำหรับการเข้าถึง LLM API
- **Qdrant**: สำหรับการเก็บและค้นหาเวกเตอร์
- **SentenceTransformer**: สำหรับการสร้างเวกเตอร์จากข้อความ
- **PyPDF2**: สำหรับการแยกข้อความจากไฟล์ PDF
- **python-dotenv**: สำหรับการจัดการ environment variables

---

## Technologies

- **Groq**: สำหรับการให้บริการ LLM API
- **Qdrant**: สำหรับฐานข้อมูลเวกเตอร์
- **Streamlit**: สำหรับเฟรมเวิร์กเว็บที่ใช้งานง่าย

---

## ติดต่อ

หากมีคำถามหรือข้อเสนอแนะ ติดต่อผู้พัฒนาที่ [GitHub](https://github.com/JeerasakAnanta)

---
